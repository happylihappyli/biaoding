using Common_Robot2;

namespace Test1
{
    public class S_New_Train : C_Node
    {
        public string key_save = "";
        public string key_time_id = "";
        public string max = "9";

        public int iMax = 9;
        public S_New_Train(string name, C_Space space_parent, C_Space space) : base(name,space_parent, space)
        {
        }


        public override Task run_sub()
        {
            run_sub_main();
            return Task.CompletedTask;
        }

        public int id = 1;
        public void run_sub_main()
        {
            Random p = new Random();
            id++;
            if (id > this.iMax) id = 1;

            
                Main.WriteLine(this,">>>>>>>>>>>>" + id + "");
            
            Random rnd = new Random();
            int train_id = rnd.Next(100, 900);
            space.pTrain = CommonMain.create_train(""+train_id);

            
            this.pTrain = space.pTrain;

            pTrain.get_ran_step().Add(this);

            this.save_var(this.key_save, "string", id + "");

            string time_id=DateTime.Now.ToString("yyyy_MM_dd__HH_mm_ss__FFF");
            pTrain.set_Time_ID(time_id);
            this.save_var(this.key_time_id, "string", time_id);

        }

        public override void init()
        {
            this.iMax = int.Parse(this.max);
        }
    }
}
