using Common_Robot;
using Common_Robot2;
using ConverxHull;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Speech.AudioFormat;
using System.Speech.Synthesis;
using System.Text;
using System.Threading.Tasks;

namespace Test1
{
    public class S_Point3D_Add : C_Node
    {
        public string key_read = "";
        public string dx = "";
        public string scale_x = "1";
        public string dy = "";
        public string scale_y = "1";
        public string dz = "";
        public string scale_z = "1";
        public string key_save = "";

        public S_Point3D_Add(string name, C_Space space_parent, C_Space space) :
            base(name, space_parent, space)
        {
            //this.Name = Name;
            //space.vars_step.Add(name, this);
        }

        public override void init()
        {
            
        }

        public override Task run_sub()
        {
            run_sub_main();
            return Task.CompletedTask;
        }

        public void run_sub_main()
        {
            C_Point3D point1 = (C_Point3D)this.read_var(this.key_read, "C_Point3D");

            if (point1 == null)
            {
                Main.WriteLine(this, "point1=null");
                return;
            }

            string str_dx = this.read_string(this.dx);
            string str_dy = this.read_string(this.dy);
            string str_dz = this.read_string(this.dz);

            float f_dx = 0;
            float f_dy = 0;
            float f_dz = 0;

            float f_scale_x = 0;
            float f_scale_y = 0;
            float f_scale_z = 0;

            try
            {
                f_dx = float.Parse(str_dx);
                f_dy = float.Parse(str_dy);
                f_dz = float.Parse(str_dz);

                string str_scale_x = this.read_string(this.scale_x);
                string str_scale_y = this.read_string(this.scale_y);
                string str_scale_z = this.read_string(this.scale_z);

                f_scale_x = float.Parse(str_scale_x);
                f_scale_y = float.Parse(str_scale_y);
                f_scale_z = float.Parse(str_scale_z);
            }
            catch (Exception ex)
            {
                Main.WriteLine(this,ex.ToString());
            }

            if (this.Name== "偏移C_Point3D2")
            {
                Main.WriteLine(this,"D");
            }


            C_Point3D point2 = new C_Point3D(point1.x + f_dx * f_scale_x, point1.y + f_dy * f_scale_y, point1.z + f_dz * f_scale_z);

            this.save_var(this.key_save,"C_Point3D", point2);
        }

    }
}
