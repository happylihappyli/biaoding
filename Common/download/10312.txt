using Common_Robot2;
using System.Diagnostics;

namespace Test1
{
    public class S_Open_Select : C_Node
    {
        public string url = "";


        public S_Open_Select(string name, C_Space space_parent, C_Space space) :
            base(space_parent, space)
        {
            this.Name = name;
            space.vars_step.Add(Name, this);
        }



        public override Task run_sub()
        {
            run_sub_main();
            return Task.CompletedTask;
        }

        public void run_sub_main()
        {
            string url_new = space.tools.var_read(pTrain, this, this.url);
            OpenFolderAndSelectFile(url_new);

        }


        private void OpenFolderAndSelectFile(String fileFullName)
        {
            string file2 = fileFullName.Replace("/", "\\");
            ProcessStartInfo psi = new ProcessStartInfo("Explorer.exe");
            psi.Arguments = "/e,/select," + file2;
            Process.Start(psi);
        }


    }


}
